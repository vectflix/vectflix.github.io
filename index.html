<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vectflix â€“ Watch Trailers</title>

<style>
    body {
        margin: 0;
        font-family: Arial, sans-serif;
        background-color: #000;
        color: #fff;
    }

    header {
        background: #141414;
        padding: 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    header h1 {
        color: #e50914;
        margin: 0;
        font-size: 28px;
    }

    #searchBar {
        padding: 8px 12px;
        border-radius: 4px;
        border: none;
        width: 200px;
    }

    .tabs {
        display: flex;
        flex-wrap: wrap;
        padding: 10px 20px;
        background: #111;
    }

    .tab {
        margin-right: 15px;
        padding: 8px 12px;
        cursor: pointer;
        border-radius: 4px;
        background: #222;
        transition: 0.2s;
    }

    .tab.active {
        background: #e50914;
        color: #fff;
    }

    .category {
        margin: 20px;
    }

    .category h2 {
        margin-bottom: 10px;
        font-size: 22px;
        border-left: 4px solid #e50914;
        padding-left: 10px;
    }

    .videos {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
        gap: 15px;
    }

    .video-card {
        background: #1a1a1a;
        border-radius: 6px;
        overflow: hidden;
        cursor: pointer;
        position: relative;
        transition: 0.3s;
    }

    .video-card:hover {
        transform: scale(1.05);
    }

    .video-card img {
        width: 100%;
        height: 260px;
        object-fit: cover;
        display: block;
    }

    .video-title {
        padding: 8px;
        font-size: 14px;
        text-align: center;
        color: #fff;
    }

    /* Hover preview iframe */
    .preview {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: none;
    }
</style>
</head>

<body>

<header>
    <h1>Vectflix</h1>
    <input type="text" id="searchBar" placeholder="Search movies/series...">
</header>

<div class="tabs" id="tabs"></div>
<div id="content"></div>

<script>
let trailersData = [];
let categories = [];

async function loadTrailers() {
    try {
        const response = await fetch("trailers.json");
        const data = await response.json();
        trailersData = data.categories;
        categories = data.categories.map(c => c.name);
        displayTabs();
        displayCategory(categories[0]);
    } catch (error) {
        document.getElementById("content").innerHTML =
            "<p style='color:red; text-align:center;'>Failed to load trailers.json</p>";
    }
}

function displayTabs() {
    const tabsContainer = document.getElementById("tabs");
    tabsContainer.innerHTML = '';
    categories.forEach((cat, i) => {
        const tab = document.createElement('div');
        tab.className = 'tab' + (i === 0 ? ' active' : '');
        tab.innerText = cat;
        tab.onclick = () => {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            tab.classList.add('active');
            displayCategory(cat);
        };
        tabsContainer.appendChild(tab);
    });
}

function displayCategory(categoryName) {
    const content = document.getElementById("content");
    content.innerHTML = '';

    const category = trailersData.find(c => c.name === categoryName);
    if (!category) return;

    const section = document.createElement('div');
    section.className = 'category';
    section.innerHTML = `<h2>${category.name}</h2>`;

    const grid = document.createElement('div');
    grid.className = 'videos';

    category.trailers.forEach(trailer => {
        const card = document.createElement('div');
        card.className = 'video-card';
        card.innerHTML = `
            <img src="${trailer.thumbnail}" alt="${trailer.title}">
            <div class="video-title">${trailer.title}</div>
        `;
        card.onclick = () => {
            window.open(trailer.url, '_blank');
        };
        grid.appendChild(card);
    });

    section.appendChild(grid);
    content.appendChild(section);
}

// Search functionality
document.getElementById('searchBar').addEventListener('input', (e) => {
    const query = e.target.value.toLowerCase();
    const filteredCategories = trailersData.map(cat => {
        return {
            name: cat.name,
            trailers: cat.trailers.filter(tr => tr.title.toLowerCase().includes(query))
        };
    }).filter(cat => cat.trailers.length > 0);

    // Update content without changing tabs
    const content = document.getElementById("content");
    content.innerHTML = '';
    filteredCategories.forEach(category => {
        const section = document.createElement('div');
        section.className = 'category';
        section.innerHTML = `<h2>${category.name}</h2>`;

        const grid = document.createElement('div');
        grid.className = 'videos';

        category.trailers.forEach(trailer => {
            const card = document.createElement('div');
            card.className = 'video-card';
            card.innerHTML = `
                <img src="${trailer.thumbnail}" alt="${trailer.title}">
                <div class="video-title">${trailer.title}</div>
            `;
            card.onclick = () => { window.open(trailer.url, '_blank'); };
            grid.appendChild(card);
        });

        section.appendChild(grid);
        content.appendChild(section);
    });
});

loadTrailers();
</script>

</body>
</html>
